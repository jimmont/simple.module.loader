<!doctype html>
<html><head><title>simple.module.loader example</title>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-1.0.0-b1/leaflet.css" />
<style>
html,body{background:white;color:black;font:1rem/1.2 sans-serif;padding:0;margin:0;height:100%;}
a.mine{color:black;display:block;font-size:1rem;}
</style>
</head>
<body>
<a class=mine style="position:fixed;padding:1em;background:white;border:1px solid #ddd;bottom:15%;right:15%;z-index:11;" href="https://github.com/jimmont/simple.module.loader">simple.module.loader example</a>
<section id="#map" style="position:relative;padding:0;margin:0;width:100%;height:100%;top:0;left:0;min-height:200px;min-width:200px;z-index:1;">
<div style="margin:15%;font-size:1rem;">
	<a class="mine" href="https://github.com/jimmont/simple.module.loader">simple.module.loader example</a>
	<h1>...setup a map here...</h1>
	<p>targets current mobile browsers (chrome/safari/crosswalk)
	<br>this message is covered by the map when it loads
	<br>so if it never goes away this likely doesn't work
	</p>
</div>
</section>
<script src="sml.js"></script>
<script>
module.require('./map.js').then(function(res){
/* without module.exports in map.js this would resolve as soon as the file loaded
	which is fine, but this way it's easier to see it resolve
	possibly setting up for other stuff
*/
	console.log('all finished', res.map);

	return res;
});

// utils for example
function http(config){
	return new Promise(function(resolve, reject){
		ajax(Object.assign(config, {
			success: resolve
			,error: reject
		}));
	});
};
function ajax(config){
	var req = document.createElement('script');
	function complete(e){
		document.body.removeChild(req);
		switch(e.type){
		case 'load':
			config.status = 211;
			config.success(config);
		break;
		default:
			config.status = 411;
			config.error(config);
		};
	};
	req.async = true;
	req.addEventListener('load', complete);
	req.addEventListener('error', complete);

	req.src = config.url;
	document.body.appendChild(req);

};
</script>
